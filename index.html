<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MIKE_TECH_WORLD STORE</title>
<style>
body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
header { display: flex; align-items: center; background: #333; color: white; padding: 10px 20px; }
header img { height: 50px; margin-right: 15px; }
header h1 { font-size: 20px; margin: 0; }

.search-bar { margin: 20px; display: flex; justify-content: center; gap: 10px; }
.search-bar input, .search-bar button { padding: 8px 12px; font-size: 14px; }

.product-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; padding: 20px; }
.product-card { border: 1px solid #ccc; border-radius: 8px; padding: 10px; text-align: center; background: #fff; }
.product-card img { width: 100%; height: 150px; object-fit: cover; border-radius: 8px; }
.product-card h3 { margin: 10px 0 5px; }
.product-card p { font-size: 14px; color: #555; }
.whatsapp-btn { display: inline-block; margin-top: 8px; padding: 8px 12px; background: #25D366; color: white; text-decoration: none; border-radius: 5px; font-size: 14px; }
.whatsapp-btn:hover { background: #1ebe5c; }

footer { text-align: center; background: #333; color: white; padding: 15px; margin-top: 20px; }
footer p { margin: 5px 0; font-size: 14px; }

.review-section { margin-top: 10px; text-align: left; }
.review-section input, .review-section button { padding: 5px; margin: 3px 0; width: 100%; border-radius: 5px; border: 1px solid #ddd; }
.logout-btn { position: absolute; top: 15px; right: 20px; padding: 6px 12px; background: #e74c3c; color: white; border: none; border-radius: 5px; cursor: pointer; }
.logout-btn:hover { background: #c0392b; }
</style>
</head>
<body>

<script>
  // Redirect to login if user not logged in
  const loggedInUser = localStorage.getItem('loggedInUser');
  if(!loggedInUser){
    window.location.href = 'login.html';
  }
</script>

<header>
  <img src="MYLOGO.JPG" alt="Store Logo">
  <h1>MIKE_TECH_WORLD STORE</h1>
  <button class="logout-btn" onclick="logoutUser()">Logout</button>
</header>

<div class="search-bar">
  <input type="text" id="searchInput" placeholder="Search product...">
  <button onclick="searchProduct()">Search</button>
  <button onclick="resetSearch()">Reset</button>
</div>

<div class="product-container" id="productContainer"></div>

<footer>
  <p>&copy; 2025 Mike_Tech_World. All Rights Reserved.</p>
  <p>Contact: 09033531912</p>
</footer>

<script>
function logoutUser(){
  localStorage.removeItem('loggedInUser');
  window.location.href='login.html';
}

function loadProducts() {
  let products = JSON.parse(localStorage.getItem("products")) || [];
  let container = document.getElementById("productContainer");
  container.innerHTML = "";

  products.forEach((product,index) => {
    let productCard = document.createElement("div");
    productCard.classList.add("product-card");

    productCard.innerHTML = `
      <img src="${product.image}" alt="${product.name}">
      <h3>${product.name}</h3>
      <p>${product.description}</p>
      <p><strong>₦${product.price}</strong></p>
      <a class="whatsapp-btn" 
         href="https://wa.me/2348137466524?text=Hello%20I%20am%20interested%20in%20${encodeURIComponent(product.name)}%20priced%20at%20₦${product.price}" 
         target="_blank">Chat on WhatsApp</a>
      <div class="review-section">
        <input type="text" id="review-${index}" placeholder="Write a review...">
        <button onclick="submitReview(${index})">Submit Review</button>
        <div id="reviews-${index}"></div>
      </div>
    `;
    container.appendChild(productCard);
    displayReviews(index);
  });
}

function searchProduct() {
  let input = document.getElementById("searchInput").value.toLowerCase();
  let products = JSON.parse(localStorage.getItem("products")) || [];
  let container = document.getElementById("productContainer");
  container.innerHTML = "";

  let filtered = products.filter(p => p.name.toLowerCase().includes(input));
  if(filtered.length===0) { container.innerHTML="<p>No product found.</p>"; return; }

  filtered.forEach((product,index) => {
    let productCard = document.createElement("div");
    productCard.classList.add("product-card");

    productCard.innerHTML = `
      <img src="${product.image}" alt="${product.name}">
      <h3>${product.name}</h3>
      <p>${product.description}</p>
      <p><strong>₦${product.price}</strong></p>
      <a class="whatsapp-btn" 
         href="https://wa.me/2348137466524?text=Hello%20I%20am%20interested%20in%20${encodeURIComponent(product.name)}%20priced%20at%20₦${product.price}" 
         target="_blank">Chat on WhatsApp</a>
      <div class="review-section">
        <input type="text" id="review-${index}" placeholder="Write a review...">
        <button onclick="submitReview(${index})">Submit Review</button>
        <div id="reviews-${index}"></div>
      </div>
    `;
    container.appendChild(productCard);
    displayReviews(index);
  });
}

function resetSearch() {
  document.getElementById("searchInput").value = "";
  loadProducts();
}

function submitReview(index){
  let reviewInput = document.getElementById(`review-${index}`);
  let reviewText = reviewInput.value.trim();
  if(!reviewText) return;

  let allReviews = JSON.parse(localStorage.getItem("reviews")) || {};
  if(!allReviews[index]) allReviews[index] = [];
  allReviews[index].push(`${loggedInUser}: ${reviewText}`);
  localStorage.setItem("reviews", JSON.stringify(allReviews));
  reviewInput.value="";
  displayReviews(index);
}

function displayReviews(index){
  let allReviews = JSON.parse(localStorage.getItem("reviews")) || {};
  let reviewsDiv = document.getElementById(`reviews-${index}`);
  reviewsDiv.innerHTML="";
  if(allReviews[index]){
    allReviews[index].forEach(r => {
      let p = document.createElement("p");
      p.style.fontSize="12px";
      p.textContent=r;
      reviewsDiv.appendChild(p);
    });
  }
}

window.onload = loadProducts;
</script>

</body>
</html>